<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Prediction - AI Models</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #3b82f6;
            --dark-bg: #1e293b;
            --card-bg: #334155;
            --text-light: #f1f5f9;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text-light);
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
        }
        
        .card {
            background-color: var(--card-bg);
            border: 1px solid #475569;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }
        
        .card:hover {
            transform: translateY(-2px);
        }
        
        .card-header {
            background-color: rgba(30, 41, 59, 0.7);
            border-bottom: 1px solid #475569;
            font-weight: 600;
            padding: 1rem 1.25rem;
        }
        
        .prediction-card {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-left: 4px solid var(--primary-color);
        }
        
        .model-card {
            border-left: 4px solid var(--info-color);
        }
        
        .performance-card {
            border-left: 4px solid var(--success-color);
        }
        
        .risk-card {
            border-left: 4px solid var(--danger-color);
        }
        
        .badge {
            font-weight: 500;
            padding: 0.35em 0.65em;
        }
        
        .price-change-positive {
            color: var(--success-color);
            font-weight: 600;
        }
        
        .price-change-negative {
            color: var(--danger-color);
            font-weight: 600;
        }
        
        .confidence-high {
            color: var(--success-color);
        }
        
        .confidence-medium {
            color: var(--warning-color);
        }
        
        .confidence-low {
            color: var(--danger-color);
        }
        
        .model-chip {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
            margin: 0.25rem;
        }
        
        .model-linear { background-color: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .model-svr { background-color: rgba(139, 92, 246, 0.2); color: #8b5cf6; }
        .model-rf { background-color: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .model-arima { background-color: rgba(245, 158, 11, 0.2); color: #f59e0b; }
        
        .metric-card {
            text-align: center;
            padding: 1rem;
            border-radius: 8px;
            background-color: rgba(30, 41, 59, 0.5);
        }
        
        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0.5rem 0;
        }
        
        .metric-label {
            font-size: 0.875rem;
            color: #94a3b8;
        }
        
        .algorithm-table th {
            border-bottom: 2px solid #475569;
            background-color: rgba(30, 41, 59, 0.7);
        }
        
        .algorithm-table td {
            border-color: #475569;
            vertical-align: middle;
        }
        
        .progress {
            height: 8px;
            background-color: #475569;
        }
        
        .progress-bar {
            background-color: var(--primary-color);
        }
        
        .tab-content {
            padding-top: 1rem;
        }
        
        .nav-tabs {
            border-bottom: 1px solid #475569;
        }
        
        .nav-tabs .nav-link {
            color: #94a3b8;
            border: 1px solid transparent;
            border-radius: 8px 8px 0 0;
            margin-right: 0.25rem;
        }
        
        .nav-tabs .nav-link.active {
            color: var(--text-light);
            background-color: var(--card-bg);
            border-color: #475569 #475569 var(--card-bg);
        }
        
        .nav-tabs .nav-link:hover {
            color: var(--text-light);
            border-color: #475569;
        }
        
        .search-box {
            max-width: 400px;
        }
        
        #loadingSpinner {
            display: none;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 1rem 0;
        }
        
        .alert {
            border-radius: 8px;
            border: none;
        }
        
        .alert-warning {
            background-color: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .alert-danger {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .alert-success {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .stock-symbol {
            font-family: 'Courier New', monospace;
            font-weight: 700;
            font-size: 1.25rem;
        }
        
        .stock-price {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .recommendation-badge {
            font-size: 1.1rem;
            padding: 0.5rem 1rem;
        }
        
        @media (max-width: 768px) {
            .stock-price {
                font-size: 1.5rem;
            }
            
            .chart-container {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #0f172a;">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2"></i>AI Stock Predictor
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/"><i class="fas fa-home me-1"></i>Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/prediction"><i class="fas fa-brain me-1"></i>Prediction</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/portfolio"><i class="fas fa-chart-pie me-1"></i>Portfolio</a>
                    </li>
                </ul>
                <div class="d-flex">
                    <div class="input-group search-box">
                        <input type="text" id="stockSearch" class="form-control" placeholder="Search stock (e.g., AAPL)" value="AAPL">
                        <button class="btn btn-primary" type="button" id="searchBtn">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="text-center mb-4">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Analyzing stock data and running AI models...</p>
        </div>

        <!-- Prediction Results -->
        <div id="predictionResults" style="display: none;">
            <!-- Stock Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card prediction-card">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-md-8">
                                    <h2 class="mb-1">
                                        <span id="stockSymbol" class="stock-symbol">AAPL</span>
                                        <span id="stockName" class="text-muted">Apple Inc.</span>
                                    </h2>
                                    <div class="d-flex align-items-center mb-2">
                                        <span id="currentPrice" class="stock-price me-3">$182.63</span>
                                        <span id="priceChange" class="price-change-positive">+1.24%</span>
                                    </div>
                                    <div class="d-flex flex-wrap gap-2">
                                        <span class="badge bg-dark">Market: <span id="marketStatus">Open</span></span>
                                        <span class="badge bg-secondary">Last Updated: <span id="lastUpdate">Just now</span></span>
                                        <span class="badge bg-info">Prediction Date: <span id="predictionDate">2024-01-15</span></span>
                                    </div>
                                </div>
                                <div class="col-md-4 text-end">
                                    <div id="recommendation" class="recommendation-badge badge bg-success">STRONG BUY</div>
                                    <div class="mt-2">
                                        <span class="text-muted">Overall Confidence:</span>
                                        <div class="d-flex align-items-center">
                                            <div class="progress flex-grow-1 me-2">
                                                <div id="confidenceBar" class="progress-bar" style="width: 85%"></div>
                                            </div>
                                            <span id="confidenceValue" class="confidence-high">85%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabs Navigation -->
            <ul class="nav nav-tabs" id="predictionTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button">
                        <i class="fas fa-chart-bar me-1"></i>Overview
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="models-tab" data-bs-toggle="tab" data-bs-target="#models" type="button">
                        <i class="fas fa-robot me-1"></i>All Models
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="performance-tab" data-bs-toggle="tab" data-bs-target="#performance" type="button">
                        <i class="fas fa-tachometer-alt me-1"></i>Performance
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="risk-tab" data-bs-toggle="tab" data-bs-target="#risk" type="button">
                        <i class="fas fa-exclamation-triangle me-1"></i>Risk Analysis
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="history-tab" data-bs-toggle="tab" data-bs-target="#history" type="button">
                        <i class="fas fa-history me-1"></i>History
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content" id="predictionTabsContent">
                <!-- Overview Tab -->
                <div class="tab-pane fade show active" id="overview" role="tabpanel">
                    <div class="row">
                        <!-- Price Predictions -->
                        <div class="col-lg-8">
                            <div class="card prediction-card">
                                <div class="card-header">
                                    <i class="fas fa-bullseye me-2"></i>Price Predictions for Tomorrow
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3 mb-3">
                                            <div class="metric-card">
                                                <div class="metric-label">OPEN</div>
                                                <div class="metric-value" id="predOpen">$183.50</div>
                                                <div id="predOpenChange" class="price-change-positive">+0.48%</div>
                                                <div class="mt-2">
                                                    <small class="text-muted">Confidence:</small>
                                                    <span id="confOpen" class="confidence-high">88%</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 mb-3">
                                            <div class="metric-card">
                                                <div class="metric-label">HIGH</div>
                                                <div class="metric-value" id="predHigh">$185.20</div>
                                                <div id="predHighChange" class="price-change-positive">+1.41%</div>
                                                <div class="mt-2">
                                                    <small class="text-muted">Confidence:</small>
                                                    <span id="confHigh" class="confidence-medium">72%</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 mb-3">
                                            <div class="metric-card">
                                                <div class="metric-label">LOW</div>
                                                <div class="metric-value" id="predLow">$181.80</div>
                                                <div id="predLowChange" class="price-change-negative">-0.45%</div>
                                                <div class="mt-2">
                                                    <small class="text-muted">Confidence:</small>
                                                    <span id="confLow" class="confidence-medium">68%</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 mb-3">
                                            <div class="metric-card">
                                                <div class="metric-label">CLOSE</div>
                                                <div class="metric-value" id="predClose">$184.50</div>
                                                <div id="predCloseChange" class="price-change-positive">+1.02%</div>
                                                <div class="mt-2">
                                                    <small class="text-muted">Confidence:</small>
                                                    <span id="confClose" class="confidence-high">85%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Prediction Chart -->
                                    <div class="chart-container">
                                        <canvas id="predictionChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Model Summary -->
                        <div class="col-lg-4">
                            <div class="card model-card">
                                <div class="card-header">
                                    <i class="fas fa-cogs me-2"></i>AI Models Summary
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <h6>Algorithms Used:</h6>
                                        <div class="d-flex flex-wrap">
                                            <span class="model-chip model-linear">Linear Regression</span>
                                            <span class="model-chip model-svr">SVR</span>
                                            <span class="model-chip model-rf">Random Forest</span>
                                            <span class="model-chip model-arima">ARIMA</span>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>Best Performing Models:</h6>
                                        <div id="bestModelsList">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>Overall Performance:</h6>
                                        <div class="row text-center">
                                            <div class="col-6 mb-2">
                                                <div class="metric-card">
                                                    <div class="metric-value" id="avgR2">0.82</div>
                                                    <div class="metric-label">Avg R² Score</div>
                                                </div>
                                            </div>
                                            <div class="col-6 mb-2">
                                                <div class="metric-card">
                                                    <div class="metric-value" id="avgDirection">78%</div>
                                                    <div class="metric-label">Direction Accuracy</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h6>Model Insights:</h6>
                                        <p id="modelInsight" class="small">Random Forest performs best for volatile stocks, while Linear Regression excels in stable markets.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All Models Tab -->
                <div class="tab-pane fade" id="models" role="tabpanel">
                    <div class="row">
                        <div class="col-12">
                            <div class="card model-card">
                                <div class="card-header">
                                    <i class="fas fa-robot me-2"></i>All Model Predictions & Performance
                                </div>
                                <div class="card-body">
                                    <!-- Model Tabs -->
                                    <ul class="nav nav-pills mb-3" id="modelTypeTabs" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link active" id="by-target-tab" data-bs-toggle="pill" data-bs-target="#by-target">By Price Target</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="by-algorithm-tab" data-bs-toggle="pill" data-bs-target="#by-algorithm">By Algorithm</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="comparison-tab" data-bs-toggle="pill" data-bs-target="#comparison">Model Comparison</button>
                                        </li>
                                    </ul>
                                    
                                    <div class="tab-content">
                                        <!-- By Target Tab -->
                                        <div class="tab-pane fade show active" id="by-target">
                                            <div class="table-responsive">
                                                <table class="table algorithm-table">
                                                    <thead>
                                                        <tr>
                                                            <th>Target</th>
                                                            <th>Linear Regression</th>
                                                            <th>SVR</th>
                                                            <th>Random Forest</th>
                                                            <th>ARIMA</th>
                                                            <th>Ensemble</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="modelPredictionsTable">
                                                        <!-- Dynamically populated -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        
                                        <!-- By Algorithm Tab -->
                                        <div class="tab-pane fade" id="by-algorithm">
                                            <div class="row" id="algorithmDetails">
                                                <!-- Dynamically populated -->
                                            </div>
                                        </div>
                                        
                                        <!-- Comparison Tab -->
                                        <div class="tab-pane fade" id="comparison">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="chart-container">
                                                        <canvas id="modelPerformanceChart"></canvas>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="chart-container">
                                                        <canvas id="modelConfidenceChart"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mt-3">
                                                <h6>Model Rankings:</h6>
                                                <div id="modelRankings">
                                                    <!-- Dynamically populated -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Tab -->
                <div class="tab-pane fade" id="performance" role="tabpanel">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="card performance-card">
                                <div class="card-header">
                                    <i class="fas fa-tachometer-alt me-2"></i>Model Performance Metrics
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table algorithm-table">
                                            <thead>
                                                <tr>
                                                    <th>Model</th>
                                                    <th>R² Score</th>
                                                    <th>MAPE</th>
                                                    <th>Direction Accuracy</th>
                                                    <th>RMSE</th>
                                                    <th>MAE</th>
                                                    <th>Bias</th>
                                                    <th>Samples</th>
                                                </tr>
                                            </thead>
                                            <tbody id="performanceMetricsTable">
                                                <!-- Dynamically populated -->
                                            </tbody>
                                        </table>
                                    </div>
                                    
                                    <div class="row mt-4">
                                        <div class="col-md-6">
                                            <div class="chart-container">
                                                <canvas id="accuracyChart"></canvas>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="chart-container">
                                                <canvas id="errorChart"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4">
                            <div class="card performance-card">
                                <div class="card-header">
                                    <i class="fas fa-medal me-2"></i>Performance Summary
                                </div>
                                <div class="card-body">
                                    <div class="mb-4">
                                        <h6>Top Performing Models:</h6>
                                        <div id="topModelsList">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h6>Performance Trends:</h6>
                                        <div id="performanceTrends">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h6>Recommendations:</h6>
                                        <div id="modelRecommendations">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Risk Analysis Tab -->
                <div class="tab-pane fade" id="risk" role="tabpanel">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="card risk-card">
                                <div class="card-header">
                                    <i class="fas fa-exclamation-triangle me-2"></i>Risk Analysis & Alerts
                                </div>
                                <div class="card-body">
                                    <div class="row mb-4">
                                        <div class="col-md-6">
                                            <div class="metric-card">
                                                <div class="metric-value" id="riskLevel">MEDIUM</div>
                                                <div class="metric-label">Overall Risk Level</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="metric-card">
                                                <div class="metric-value" id="volatility">24.5%</div>
                                                <div class="metric-label">Annual Volatility</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h6>Risk Metrics:</h6>
                                    <div class="row mb-4">
                                        <div class="col-md-3 mb-2">
                                            <div class="metric-card">
                                                <div class="metric-value" id="var95">-3.2%</div>
                                                <div class="metric-label">95% VaR</div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 mb-2">
                                            <div class="metric-card">
                                                <div class="metric-value" id="maxDrawdown">-15.4%</div>
                                                <div class="metric-label">Max Drawdown</div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 mb-2">
                                            <div class="metric-card">
                                                <div class="metric-value" id="sharpeRatio">1.24</div>
                                                <div class="metric-label">Sharpe Ratio</div>
                                            </div>
                                        </div>
                                        <div class="col-md-3 mb-2">
                                            <div class="metric-card">
                                                <div class="metric-value" id="positiveDays">58%</div>
                                                <div class="metric-label">Positive Days</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h6>Risk Alerts:</h6>
                                    <div id="riskAlerts">
                                        <!-- Dynamically populated -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4">
                            <div class="card risk-card">
                                <div class="card-header">
                                    <i class="fas fa-chart-line me-2"></i>Market Regime
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <h6>Current Regime:</h6>
                                        <div class="alert alert-warning" id="marketRegime">
                                            <i class="fas fa-info-circle me-2"></i>
                                            <strong>HIGH VOLATILITY</strong><br>
                                            <small>Market showing increased volatility</small>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>Model Risk Assessment:</h6>
                                        <div id="modelRiskAssessment">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h6>Trading Advice:</h6>
                                        <div id="tradingAdvice">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Tab -->
                <div class="tab-pane fade" id="history" role="tabpanel">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-history me-2"></i>Prediction History
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="historyChart"></canvas>
                                    </div>
                                    
                                    <div class="table-responsive mt-4">
                                        <table class="table algorithm-table">
                                            <thead>
                                                <tr>
                                                    <th>Date</th>
                                                    <th>Predicted</th>
                                                    <th>Actual</th>
                                                    <th>Error</th>
                                                    <th>Model Used</th>
                                                    <th>Confidence</th>
                                                </tr>
                                            </thead>
                                            <tbody id="historyTable">
                                                <!-- Dynamically populated -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4">
                            <div class="card">
                                <div class="card-header">
                                    <i class="fas fa-chart-bar me-2"></i>Historical Accuracy
                                </div>
                                <div class="card-body">
                                    <div class="mb-4">
                                        <h6>Accuracy Over Time:</h6>
                                        <div id="accuracyTrend">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                    
                                    <div class="mb-4">
                                        <h6>Model Performance History:</h6>
                                        <div id="modelHistory">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h6>Insights:</h6>
                                        <p id="historyInsights" class="small">Models have improved accuracy during stable market periods. Consider retraining during high volatility.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global variables
        let predictionData = null;
        let charts = {};
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Bootstrap components
            const tabs = document.querySelectorAll('#predictionTabs button[data-bs-toggle="tab"]');
            tabs.forEach(tab => {
                tab.addEventListener('shown.bs.tab', function (event) {
                    // Update charts when tab changes
                    updateChartsForTab(event.target.getAttribute('data-bs-target'));
                });
            });
            
            // Search functionality
            document.getElementById('searchBtn').addEventListener('click', searchStock);
            document.getElementById('stockSearch').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') searchStock();
            });
            
            // Load default stock
            searchStock();
        });
        
        // Search for stock predictions
        async function searchStock() {
            const symbol = document.getElementById('stockSearch').value.trim().toUpperCase();
            if (!symbol) return;
            
            // Show loading
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('predictionResults').style.display = 'none';
            
            try {
                const response = await fetch('/api/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ symbol: symbol })
                });
                
                if (!response.ok) {
                    throw new Error('Prediction failed');
                }
                
                predictionData = await response.json();
                
                // Check if it's fallback
                if (predictionData.fallback) {
                    showAlert('warning', 'Using fallback prediction engine due to model unavailability');
                }
                
                // Update UI with prediction data
                updatePredictionUI();
                
                // Hide loading, show results
                document.getElementById('loadingSpinner').style.display = 'none';
                document.getElementById('predictionResults').style.display = 'block';
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loadingSpinner').style.display = 'none';
                showAlert('danger', 'Failed to get predictions. Please try again.');
            }
        }
        
        // Update UI with prediction data
        function updatePredictionUI() {
            if (!predictionData) return;
            
            // Basic stock info
            document.getElementById('stockSymbol').textContent = predictionData.symbol;
            document.getElementById('currentPrice').textContent = `$${predictionData.current_prices.close.toFixed(2)}`;
            document.getElementById('marketStatus').textContent = predictionData.market_status;
            document.getElementById('predictionDate').textContent = predictionData.prediction_date;
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            
            // Recommendation and confidence
            document.getElementById('recommendation').textContent = predictionData.trading_recommendation;
            document.getElementById('recommendation').className = getRecommendationBadgeClass(predictionData.trading_recommendation);
            
            const confidence = predictionData.confidence_metrics.overall_confidence;
            document.getElementById('confidenceValue').textContent = `${confidence.toFixed(1)}%`;
            document.getElementById('confidenceBar').style.width = `${confidence}%`;
            document.getElementById('confidenceValue').className = getConfidenceClass(confidence);
            
            // Price predictions
            updatePricePredictions();
            
            // Model summary
            updateModelSummary();
            
            // Model predictions table
            updateModelPredictionsTable();
            
            // Performance metrics
            updatePerformanceMetrics();
            
            // Risk analysis
            updateRiskAnalysis();
            
            // Charts
            updateAllCharts();
        }
        
        // Update price predictions
        function updatePricePredictions() {
            const predictions = predictionData.predictions;
            
            for (const [target, data] of Object.entries(predictions)) {
                const elem = document.getElementById(`pred${target}`);
                if (elem) {
                    elem.textContent = `$${data.predicted_price.toFixed(2)}`;
                }
                
                const changeElem = document.getElementById(`pred${target}Change`);
                if (changeElem) {
                    const change = data.expected_change;
                    changeElem.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                    changeElem.className = change >= 0 ? 'price-change-positive' : 'price-change-negative';
                }
                
                const confElem = document.getElementById(`conf${target}`);
                if (confElem) {
                    const conf = data.confidence;
                    confElem.textContent = `${conf.toFixed(1)}%`;
                    confElem.className = getConfidenceClass(conf);
                }
            }
        }
        
        // Update model summary
        function updateModelSummary() {
            const summary = predictionData.performance_summary || {};
            
            // Best models
            const bestModelsList = document.getElementById('bestModelsList');
            if (bestModelsList && summary.best_models) {
                bestModelsList.innerHTML = summary.best_models.map(model => `
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <span>${model.target}:</span>
                        <span class="badge bg-info">${model.algorithm.replace('_', ' ').toUpperCase()}</span>
                    </div>
                `).join('');
            }
            
            // Performance metrics
            const avgMetrics = summary.avg_metrics || {};
            if (avgMetrics.avg_r2) {
                document.getElementById('avgR2').textContent = avgMetrics.avg_r2.toFixed(2);
            }
            if (avgMetrics.avg_direction_accuracy) {
                document.getElementById('avgDirection').textContent = `${avgMetrics.avg_direction_accuracy.toFixed(0)}%`;
            }
            
            // Model insight
            const insight = document.getElementById('modelInsight');
            if (insight && predictionData.insight) {
                insight.textContent = predictionData.insight;
            }
        }
        
        // Update model predictions table
        function updateModelPredictionsTable() {
            const table = document.getElementById('modelPredictionsTable');
            if (!table || !predictionData.algorithm_predictions) return;
            
            let html = '';
            const algorithms = ['linear_regression', 'svr', 'random_forest', 'arima'];
            
            for (const [target, data] of Object.entries(predictionData.algorithm_predictions)) {
                if (!data.individual) continue;
                
                html += `
                    <tr>
                        <td><strong>${target}</strong></td>
                        ${algorithms.map(algo => {
                            const pred = data.individual[algo];
                            const conf = data.confidences ? data.confidences[algo] : 0;
                            return pred ? `
                                <td>
                                    <div>$${pred.toFixed(2)}</div>
                                    <small class="${getConfidenceClass(conf)}">${conf.toFixed(0)}%</small>
                                </td>
                            ` : `<td class="text-muted">N/A</td>`;
                        }).join('')}
                        <td>
                            <div><strong>$${data.ensemble.toFixed(2)}</strong></div>
                            <small class="${getConfidenceClass(data.ensemble_confidence)}">${data.ensemble_confidence.toFixed(0)}%</small>
                        </td>
                    </tr>
                `;
            }
            
            table.innerHTML = html;
            
            // Update algorithm details
            updateAlgorithmDetails();
        }
        
        // Update algorithm details
        function updateAlgorithmDetails() {
            const container = document.getElementById('algorithmDetails');
            if (!container || !predictionData.algorithm_full_details) return;
            
            const algorithms = {};
            
            // Group by algorithm
            for (const [key, data] of Object.entries(predictionData.algorithm_full_details)) {
                const algo = data.algorithm;
                if (!algorithms[algo]) {
                    algorithms[algo] = {
                        info: data.model_info,
                        predictions: []
                    };
                }
                algorithms[algo].predictions.push(data);
            }
            
            let html = '';
            for (const [algo, data] of Object.entries(algorithms)) {
                const avgConfidence = data.predictions.reduce((sum, p) => sum + p.confidence, 0) / data.predictions.length;
                
                html += `
                    <div class="col-md-6 mb-3">
                        <div class="card h-100">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span class="model-chip model-${algo.split('_')[0]}">
                                    ${data.info?.name || algo.replace('_', ' ').toUpperCase()}
                                </span>
                                <span class="${getConfidenceClass(avgConfidence)}">${avgConfidence.toFixed(0)}%</span>
                            </div>
                            <div class="card-body">
                                <p class="small">${data.info?.description || ''}</p>
                                
                                <h6>Predictions:</h6>
                                ${data.predictions.map(p => `
                                    <div class="d-flex justify-content-between mb-1">
                                        <span>${p.target}:</span>
                                        <span>$${p.prediction.toFixed(2)}</span>
                                    </div>
                                `).join('')}
                                
                                <div class="mt-3">
                                    <h6>Strengths:</h6>
                                    <div class="d-flex flex-wrap">
                                        ${(data.info?.strengths || []).map(s => `
                                            <span class="badge bg-success me-1 mb-1">${s}</span>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }
        
        // Update performance metrics
        function updatePerformanceMetrics() {
            const table = document.getElementById('performanceMetricsTable');
            if (!table || !predictionData.historical_performance) return;
            
            let html = '';
            const algorithms = ['linear_regression', 'svr', 'random_forest', 'arima'];
            
            for (const [target, models] of Object.entries(predictionData.historical_performance)) {
                for (const [algo, metrics] of Object.entries(models)) {
                    html += `
                        <tr>
                            <td>
                                <span class="model-chip model-${algo.split('_')[0]}">
                                    ${algo.replace('_', ' ').toUpperCase()}
                                </span>
                                <small class="text-muted">(${target})</small>
                            </td>
                            <td>${metrics.r2 ? metrics.r2.toFixed(3) : 'N/A'}</td>
                            <td>${metrics.mape ? `${metrics.mape.toFixed(2)}%` : 'N/A'}</td>
                            <td>${metrics.direction_accuracy ? `${metrics.direction_accuracy.toFixed(1)}%` : 'N/A'}</td>
                            <td>${metrics.rmse ? metrics.rmse.toFixed(2) : 'N/A'}</td>
                            <td>${metrics.mae ? metrics.mae.toFixed(2) : 'N/A'}</td>
                            <td>${metrics.bias ? metrics.bias.toFixed(3) : 'N/A'}</td>
                            <td>${metrics.sample_size || 'N/A'}</td>
                        </tr>
                    `;
                }
            }
            
            table.innerHTML = html;
            
            // Update top models list
            updateTopModelsList();
        }
        
        // Update top models list
        function updateTopModelsList() {
            const container = document.getElementById('topModelsList');
            if (!container || !predictionData.historical_performance) return;
            
            // Find top models by R² score
            const topModels = [];
            for (const [target, models] of Object.entries(predictionData.historical_performance)) {
                for (const [algo, metrics] of Object.entries(models)) {
                    if (metrics.r2) {
                        topModels.push({
                            target,
                            algorithm: algo,
                            r2: metrics.r2,
                            direction: metrics.direction_accuracy
                        });
                    }
                }
            }
            
            topModels.sort((a, b) => b.r2 - a.r2);
            const top5 = topModels.slice(0, 5);
            
            let html = '';
            top5.forEach((model, index) => {
                html += `
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <div>
                            <span class="badge bg-dark me-2">#${index + 1}</span>
                            <span class="model-chip model-${model.algorithm.split('_')[0]}">
                                ${model.algorithm.replace('_', ' ').toUpperCase()}
                            </span>
                            <small class="text-muted">(${model.target})</small>
                        </div>
                        <div>
                            <span class="me-2">R²: ${model.r2.toFixed(3)}</span>
                            <span>Acc: ${model.direction ? `${model.direction.toFixed(1)}%` : 'N/A'}</span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<p class="text-muted">No performance data available</p>';
        }
        
        // Update risk analysis
        function updateRiskAnalysis() {
            const riskMetrics = predictionData.risk_metrics || {};
            
            // Risk level
            document.getElementById('riskLevel').textContent = predictionData.risk_level || 'UNKNOWN';
            document.getElementById('riskLevel').style.color = getRiskColor(predictionData.risk_level);
            
            // Risk metrics
            if (riskMetrics.volatility) {
                document.getElementById('volatility').textContent = `${riskMetrics.volatility.toFixed(1)}%`;
            }
            if (riskMetrics.var_95) {
                document.getElementById('var95').textContent = `${riskMetrics.var_95.toFixed(1)}%`;
            }
            if (riskMetrics.max_drawdown) {
                document.getElementById('maxDrawdown').textContent = `${riskMetrics.max_drawdown.toFixed(1)}%`;
            }
            if (riskMetrics.sharpe_ratio) {
                document.getElementById('sharpeRatio').textContent = riskMetrics.sharpe_ratio.toFixed(2);
            }
            if (riskMetrics.positive_days) {
                document.getElementById('positiveDays').textContent = `${riskMetrics.positive_days.toFixed(0)}%`;
            }
            
            // Risk alerts
            updateRiskAlerts();
            
            // Market regime
            updateMarketRegime();
        }
        
        // Update risk alerts
        function updateRiskAlerts() {
            const container = document.getElementById('riskAlerts');
            if (!container || !predictionData.risk_alerts) return;
            
            let html = '';
            predictionData.risk_alerts.forEach(alert => {
                const alertClass = getAlertClass(alert.level);
                html += `
                    <div class="alert ${alertClass} mb-2">
                        <div class="d-flex">
                            <div class="me-2">${alert.level}</div>
                            <div>
                                <strong>${alert.type}:</strong> ${alert.message}
                                ${alert.details ? `<div class="small mt-1">${alert.details}</div>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html || '<p class="text-muted">No risk alerts</p>';
        }
        
        // Update market regime
        function updateMarketRegime() {
            // This would be populated from prediction data
            // For now, using sample data
            const regime = document.getElementById('marketRegime');
            if (regime) {
                regime.innerHTML = `
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>NORMAL MARKET</strong><br>
                    <small>Standard market conditions</small>
                `;
            }
        }
        
        // Update all charts
        function updateAllCharts() {
            // Destroy existing charts
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });
            charts = {};
            
            // Create new charts
            createPredictionChart();
            createPerformanceChart();
            createConfidenceChart();
            createAccuracyChart();
            createErrorChart();
            createHistoryChart();
        }
        
        // Create prediction chart
        function createPredictionChart() {
            const ctx = document.getElementById('predictionChart').getContext('2d');
            
            const predictions = predictionData.predictions;
            const currentPrices = predictionData.current_prices;
            
            const labels = ['Current', 'Predicted'];
            const openData = [currentPrices.open, predictions.Open.predicted_price];
            const highData = [currentPrices.high, predictions.High.predicted_price];
            const lowData = [currentPrices.low, predictions.Low.predicted_price];
            const closeData = [currentPrices.close, predictions.Close.predicted_price];
            
            charts.prediction = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Open',
                            data: openData,
                            backgroundColor: 'rgba(59, 130, 246, 0.5)',
                            borderColor: 'rgb(59, 130, 246)',
                            borderWidth: 1
                        },
                        {
                            label: 'High',
                            data: highData,
                            backgroundColor: 'rgba(16, 185, 129, 0.5)',
                            borderColor: 'rgb(16, 185, 129)',
                            borderWidth: 1
                        },
                        {
                            label: 'Low',
                            data: lowData,
                            backgroundColor: 'rgba(245, 158, 11, 0.5)',
                            borderColor: 'rgb(245, 158, 11)',
                            borderWidth: 1
                        },
                        {
                            label: 'Close',
                            data: closeData,
                            backgroundColor: 'rgba(139, 92, 246, 0.5)',
                            borderColor: 'rgb(139, 92, 246)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toFixed(2);
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Current vs Predicted Prices'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: $${context.parsed.y.toFixed(2)}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Create performance chart
        function createPerformanceChart() {
            const ctx = document.getElementById('modelPerformanceChart').getContext('2d');
            
            // Sample data - replace with actual performance data
            const labels = ['Linear Regression', 'SVR', 'Random Forest', 'ARIMA'];
            const r2Data = [0.82, 0.78, 0.85, 0.72];
            const directionData = [76, 72, 81, 68];
            
            charts.performance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['R² Score', 'Direction Accuracy', 'Precision', 'Speed', 'Stability'],
                    datasets: [
                        {
                            label: 'Linear Regression',
                            data: [0.82, 76, 85, 95, 88],
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.2)'
                        },
                        {
                            label: 'SVR',
                            data: [0.78, 72, 82, 70, 85],
                            borderColor: 'rgb(139, 92, 246)',
                            backgroundColor: 'rgba(139, 92, 246, 0.2)'
                        },
                        {
                            label: 'Random Forest',
                            data: [0.85, 81, 88, 75, 82],
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.2)'
                        },
                        {
                            label: 'ARIMA',
                            data: [0.72, 68, 78, 85, 79],
                            borderColor: 'rgb(245, 158, 11)',
                            backgroundColor: 'rgba(245, 158, 11, 0.2)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Model Performance Comparison'
                        }
                    }
                }
            });
        }
        
        // Create confidence chart
        function createConfidenceChart() {
            const ctx = document.getElementById('modelConfidenceChart').getContext('2d');
            
            // Sample data - replace with actual confidence data
            const labels = ['Open', 'High', 'Low', 'Close'];
            const linearData = [88, 72, 68, 85];
            const svrData = [82, 75, 70, 80];
            const rfData = [85, 78, 72, 82];
            const arimaData = [75, 68, 65, 74];
            
            charts.confidence = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Linear Regression',
                            data: linearData,
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.3
                        },
                        {
                            label: 'SVR',
                            data: svrData,
                            borderColor: 'rgb(139, 92, 246)',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            tension: 0.3
                        },
                        {
                            label: 'Random Forest',
                            data: rfData,
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.3
                        },
                        {
                            label: 'ARIMA',
                            data: arimaData,
                            borderColor: 'rgb(245, 158, 11)',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Model Confidence by Price Target'
                        }
                    }
                }
            });
        }
        
        // Create accuracy chart
        function createAccuracyChart() {
            const ctx = document.getElementById('accuracyChart').getContext('2d');
            
            charts.accuracy = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Linear', 'SVR', 'RF', 'ARIMA'],
                    datasets: [
                        {
                            label: 'R² Score',
                            data: [0.82, 0.78, 0.85, 0.72],
                            backgroundColor: 'rgba(59, 130, 246, 0.5)'
                        },
                        {
                            label: 'Direction Accuracy',
                            data: [76, 72, 81, 68],
                            backgroundColor: 'rgba(16, 185, 129, 0.5)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 1,
                            ticks: {
                                callback: function(value) {
                                    if (value <= 1) return value.toFixed(2);
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Model Accuracy Metrics'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.label === 'Direction Accuracy') {
                                        label += context.parsed.y + '%';
                                    } else {
                                        label += context.parsed.y.toFixed(3);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Create error chart
        function createErrorChart() {
            const ctx = document.getElementById('errorChart').getContext('2d');
            
            charts.error = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Linear', 'SVR', 'RF', 'ARIMA'],
                    datasets: [
                        {
                            label: 'MAPE (%)',
                            data: [3.2, 3.8, 2.9, 4.5],
                            backgroundColor: 'rgba(245, 158, 11, 0.5)'
                        },
                        {
                            label: 'RMSE',
                            data: [2.1, 2.4, 1.8, 2.8],
                            backgroundColor: 'rgba(239, 68, 68, 0.5)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Model Error Metrics (Lower is Better)'
                        }
                    }
                }
            });
        }
        
        // Create history chart
        function createHistoryChart() {
            const ctx = document.getElementById('historyChart').getContext('2d');
            
            // Sample historical data
            const dates = [];
            for (let i = 14; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                dates.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
            }
            
            charts.history = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'Predicted Close',
                            data: Array(15).fill(0).map(() => 180 + Math.random() * 10),
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.3
                        },
                        {
                            label: 'Actual Close',
                            data: Array(15).fill(0).map(() => 180 + Math.random() * 10),
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toFixed(2);
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Historical Predictions vs Actual'
                        }
                    }
                }
            });
        }
        
        // Update charts for active tab
        function updateChartsForTab(tabId) {
            // Charts are already created, just ensure they're properly sized
            Object.values(charts).forEach(chart => {
                if (chart) chart.resize();
            });
        }
        
        // Helper functions
        function getConfidenceClass(confidence) {
            if (confidence >= 80) return 'confidence-high';
            if (confidence >= 60) return 'confidence-medium';
            return 'confidence-low';
        }
        
        function getRecommendationBadgeClass(recommendation) {
            const lower = recommendation.toLowerCase();
            if (lower.includes('strong buy') || lower.includes('buy')) return 'recommendation-badge badge bg-success';
            if (lower.includes('strong sell') || lower.includes('sell')) return 'recommendation-badge badge bg-danger';
            if (lower.includes('hold')) return 'recommendation-badge badge bg-warning';
            return 'recommendation-badge badge bg-secondary';
        }
        
        function getRiskColor(riskLevel) {
            const lower = riskLevel.toLowerCase();
            if (lower.includes('extreme')) return '#ef4444';
            if (lower.includes('high')) return '#f59e0b';
            if (lower.includes('medium')) return '#3b82f6';
            return '#10b981';
        }
        
        function getAlertClass(level) {
            if (level.includes('CRITICAL')) return 'alert-danger';
            if (level.includes('HIGH')) return 'alert-warning';
            return 'alert-success';
        }
        
        function showAlert(type, message) {
            const alertClass = `alert-${type}`;
            const alert = document.createElement('div');
            alert.className = `alert ${alertClass} alert-dismissible fade show position-fixed top-0 end-0 m-3`;
            alert.style.zIndex = '1050';
            alert.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(alert);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.parentNode.removeChild(alert);
                }
            }, 5000);
        }
    </script>
</body>
</html>